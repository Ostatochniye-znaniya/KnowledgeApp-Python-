// сначала middleware аутентификация, потом проверка роли
const authMiddleware = require('./middleware/auth'); // декодирует JWT и ставит req.user

// только руководитель может менять статус участия группы
app.post(
  '/api/groups/:groupId/participation',
  authMiddleware,
  requireRole(['leader']),  // доступ только для роли "руководитель"
  (req, res) => {
    const { groupId } = req.params;
    const { status } = req.body;

    // здесь уже можно безопасно сохранять статус участия
    // ...
    res.status(200).json({ groupId, status });
  }
);
